---

- name: Install postgresql
  apt: name=postgresql-9.5 state=present
  become_user: root
  tags: ["postgresql-server"]

- name: Install postgresql-contrib
  apt: name=postgresql-contrib state=present
  become_user: root
  tags: ["postgresql-contrib"]

- name: Install postgresql-plpython-9.5
  apt: name=postgresql-plpython-9.5 state=present
  become_user: root
  tags: ["postgresql-contrib"]

- name: create custom tablespace directory
  file: name=/opt/postgresql/main state=directory owner=postgres
  become_user: root
  tags: ["postgresql-tablespace"]

- name: Copy postgresql.conf
  template: src="postgresql.conf" dest=/etc/postgresql/9.5/main/postgresql.conf
  become_user: root
  tags: ["postgresql-conf"]

- name: Copy text search dictionaries - hunspell
  template: >-
    src={{ item.src }}
    dest=/usr/share/postgresql/9.5/tsearch_data/{{ item.dest }}
    owner=root
  with_items:
    - {src: "hunspell_en_gb.affix", dest: "hunspell_en_gb.affix"}
    - {src: "hunspell_en_gb.dict", dest: "hunspell_en_gb.dict"}
    - {src: "hunspell_en_us.affix", dest: "hunspell_en_us.affix"}
    - {src: "hunspell_en_us.dict", dest: "hunspell_en_us.dict"}
